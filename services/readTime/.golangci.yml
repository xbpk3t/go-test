---

# [Configuration | golangci-lint](https://golangci-lint.run/usage/configuration/)
linters:
  disable-all: true
  enable:
    - bodyclose # å¯¹ HTTP å“åº”æ˜¯å¦ close æˆåŠŸæ£€æµ‹
    - deadcode # å‘ç°æ²¡æœ‰ä½¿ç”¨çš„ä»£ç 
    - depguard
    - dogsled
    - dupl # ä»£ç å…‹éš†ç›‘æµ‹å·¥å…·
    - errcheck # ç”¨äºæ£€æŸ¥æœ‰errorè¿”å›çš„å‡½æ•°ï¼Œå´æ²¡æœ‰åšåˆ¤æ–­æ£€æŸ¥
    - exportloopref # æŸ¥çœ‹å˜é‡ä½œç”¨åŸŸï¼ŒWARN [runner] The linter 'scopelint' is deprecated (since v1.39.0) due to: The repository of the linter has been deprecated by the owner.  Replaced by exportloopref.
    - exhaustive # æ£€æŸ¥æšä¸¾switchè¯­å¥çš„è¦†ç›–ç‡
    - funlen # æ£€æŸ¥é•¿å‡½æ•°çš„linterï¼Œç”¨æ¥æ£€æŸ¥è¡Œæ•°ï¼Œé»˜è®¤é™åˆ¶60è¡Œå’Œ40ä¸ªstatement
    - goconst # æŸ¥æ‰¾é‡å¤çš„å­—ç¬¦ä¸²ï¼Œè¿™äº›å­—ç¬¦ä¸²å¯ä»¥æŠ½å–æˆå¸¸é‡
    - gocritic
    - gocyclo # ç”¨æ¥æ£€æŸ¥å‡½æ•°çš„å¤æ‚åº¦
    - gofmt # æ£€æµ‹ä»£ç æ˜¯å¦éƒ½å·²ç»æ ¼å¼åŒ–, é»˜è®¤æƒ…å†µä¸‹ä½¿ç”¨ -s æ¥æ£€æŸ¥ä»£ç æ˜¯å¦ç®€åŒ–
    - goimports # åšæ‰€æœ‰ gofmt åšçš„äº‹. æ­¤å¤–è¿˜æ£€æŸ¥æœªä½¿ç”¨çš„å¯¼å…¥
    - goprintffuncname
    - gosec
    - gosimple # ç”¨æ¥æ£€æµ‹ä»£ç æ˜¯å¦è¿˜æœ‰å¯ä»¥ç®€åŒ–çš„åœ°æ–¹
    - govet # (vet, vetshadow): æ£€æŸ¥goæºä»£ç å¹¶æŠ¥å‘Šå¯ç–‘ç»“æ„ï¼Œä¾‹å¦‚ Printf è°ƒç”¨ï¼Œå…¶å‚æ•°ä¸æ ¼å¼å­—ç¬¦ä¸²ä¸ä¸€è‡´ # ç”¨`vet`åšå˜é‡è¦†ç›–æ£€æµ‹ï¼Œæ¯”å¦‚å˜é‡èµ‹å€¼ã€å‡½æ•°ä¼ å‚ã€å‡½æ•°è¿”å›å€¼ã€éå†æ•°æ®ã€structåˆå§‹åŒ–ç­‰åœºæ™¯ï¼Œå¯ä»¥æ£€æŸ¥æ˜¯å¦æœ‰è¯»å†™é”éšå¼å¤åˆ¶çš„æƒ…å†µ(vetåŒ…å«åœ¨golangé»˜è®¤å·¥å…·å¥—ä»¶)
    - ineffassign # æ£€æµ‹æ˜¯å¦æœ‰æœªä½¿ç”¨çš„ä»£ç ã€å˜é‡ã€å¸¸é‡ã€ç±»å‹ã€ç»“æ„ä½“ã€å‡½æ•°ã€å‡½æ•°å‚æ•°ç­‰
    - lll
    - misspell # æŸ¥æ‰¾å•è¯æ‹¼å†™é”™è¯¯
    - nakedret
    - nolintlint
    - rowserrcheck
    - staticcheck # æä¾›äº†å·¨å¤šçš„é™æ€æ£€æŸ¥ï¼Œæ£€æŸ¥bugï¼Œåˆ†ææ€§èƒ½ç­‰
    - structcheck # å‘ç°æœªä½¿ç”¨çš„ç»“æ„ä½“å­—æ®µ
    - stylecheck
    - typecheck # å¯¹ go ä»£ç è¿›è¡Œè§£æå’Œç±»å‹æ£€æŸ¥
    - unconvert
    - unparam
    - unused # æ£€æŸ¥æœªä½¿ç”¨çš„å¸¸é‡ï¼Œå˜é‡ï¼Œå‡½æ•°å’Œç±»å‹
    - varcheck # æŸ¥æ‰¾æœªä½¿ç”¨çš„å…¨å±€å˜é‡å’Œå¸¸é‡
    - whitespace
    - gomnd
    - revive # æ‰“å°å‡º go ä»£ç çš„æ ¼å¼é”™è¯¯ï¼ŒWARN [runner] The linter 'golint' is deprecated (since v1.41.0) due to: The repository of the linter has been archived by the owner.  Replaced by revive. # æ£€æŸ¥æ˜¯å¦æœ‰æ­»é”çš„é™æ€æ£€æµ‹å·¥å…·
#    - gochecknoglobals # æ£€æŸ¥ go ä»£ç ä¸­æ˜¯å¦å­˜åœ¨å…¨å±€å˜é‡
    - exhaustivestruct # æ£€æŸ¥structçš„å­—æ®µæ˜¯å¦éƒ½å·²åˆå§‹åŒ–
    - gochecknoinits # æ£€æŸ¥initå‡½æ•°
    - noctx # [sonatard/noctx: noctx finds sending http request without context.Context.](https://github.com/sonatard/noctx)
    - sloglint # [go-simpler/sloglint: ğŸªµ Ensure consistent code style when using log/slog](https://github.com/go-simpler/sloglint)

  # don't enable:
  # - asciicheck
  # - scopelint
  # - gocognit
  # - godot
  # - godox
  # - goerr113
  # - interfacer
  # - maligned # å·²åºŸå¼ƒ, ç”¨govetçš„fieldalignmentä»£æ›¿
  # - nestif
  # - prealloc
  # - testpackage
  # - sqlrows # æ£€æŸ¥ä½¿ç”¨`*sql.Rows`æ—¶çš„ä¸€äº›é”™è¯¯
  # - wsl

linters-settings:
  depguard:
    list-type: blacklist
    packages:
      # logging is allowed only by logutils.Log, logrus
      # is allowed to use only in logutils package
      - github.com/sirupsen/logrus
    packages-with-error-message:
      # specify an error message to output when a blacklisted package is used
      - github.com/sirupsen/logrus: "logging is allowed only by logutils.Log"
  dupl:
    threshold: 100
  funlen:
    lines: 100
    statements: 50
  gci:
    local-prefixes: github.com/golangci/golangci-lint
  goconst:
    min-len: 2
    min-occurrences: 2

  # [go-critic/go-critic: The most opinionated Go source code linter for code audit.](https://github.com/go-critic/go-critic)
  gocritic:
    enabled-tags:
      - diagnostic
      - experimental
      - opinionated
      - performance
      - style # æ£€æŸ¥æ˜¯å¦æœ‰æ³¨é‡Šå¹¶ä¸”æ²¡ç”¨çš„ä»£ç 
    disabled-checks:
      - dupImport # https://github.com/go-critic/go-critic/issues/845
      - ifElseChain
      - octalLiteral
      - whyNoLint
      - wrapperFunc
  gocyclo:
    min-complexity: 40
  goimports:
    local-prefixes: github.com/golangci/golangci-lint

  gomnd:
    settings:
      mnd:
        # don't include the "operation" and "assign"
        # argumentä¼šæ£€æŸ¥å‡½æ•°å‚æ•°å¤§å°ï¼Œä»¥åŠæ˜¯å¦ä½¿ç”¨magic numberï¼Œå»æ‰
        # conditionä¹Ÿä¼šæ£€æŸ¥æ˜¯å¦ä½¿ç”¨magic number
        checks: [case,return]
        ignored-numbers: 0,1,2,3,4,5,6,7,8,9,10,1000
        ignored-files: magic_.*.go
        ignored-functions: math.*

  govet: # å¯¹äºlinter govetï¼Œæˆ‘ä»¬æ‰‹åŠ¨å¼€å¯äº†å®ƒçš„æŸäº›æ‰«æè§„åˆ™
    check-shadowing: true
    check-unreachable: true
    check-rangeloops: true
    check-copylocks: true
    settings:
      printf:
        funcs:
          - (github.com/golangci/golangci-lint/pkg/logutils.Log).Infof
          - (github.com/golangci/golangci-lint/pkg/logutils.Log).Warnf
          - (github.com/golangci/golangci-lint/pkg/logutils.Log).Errorf
          - (github.com/golangci/golangci-lint/pkg/logutils.Log).Fatalf
    enable:
      - atomicalign # ä¹Ÿå°±æ˜¯fieldalignmentï¼Œæ£€æŸ¥structå†…å­˜å¯¹é½
    enable-all: false
    disable:
      - shadow
    disable-all: false

  lll:
    line-length: 300
  maligned:
    suggest-new: true
  misspell:
    locale: US
  nolintlint:
    allow-leading-space: true # don't require machine-readable nolint directives (i.e. with no leading space)
    allow-unused: false # report any unused nolint directives
    require-explanation: false # don't require an explanation for nolint directives
    require-specific: false # don't require nolint directives to be specific about which linter is being skipped

  stylecheck:
    # Select the Go version to target. The default is '1.13'.
    go: "1.17"
    # https://staticcheck.io/docs/options#checks
    checks: [ "all", "-ST1000", "-ST1003", "-ST1016", "-ST1020", "-ST1021", "-ST1022" ]
    # https://staticcheck.io/docs/options#dot_import_whitelist
    dot-import-whitelist:
      - fmt
    # https://staticcheck.io/docs/options#initialisms
    initialisms: [ "ACL", "API", "ASCII", "CPU", "CSS", "DNS", "EOF", "GUID", "HTML", "HTTP", "HTTPS", "ID", "IP", "JSON", "QPS", "RAM", "RPC", "SLA", "SMTP", "SQL", "SSH", "TCP", "TLS", "TTL", "UDP", "UI", "GID", "UID", "UUID", "URI", "URL", "UTF8", "VM", "XML", "XMPP", "XSRF", "XSS" ]
    # https://staticcheck.io/docs/options#http_status_code_whitelist
    http-status-code-whitelist: [ "200", "400", "404", "500" ]

  revive:
    # see https://github.com/mgechev/revive#available-rules for details.
    ignore-generated-header: true
    severity: warning
    rules:
      - name: indent-error-flow
        severity: warning
      - name: add-constant
        severity: warning
        arguments:
          - maxLitCount: "5"
            allowStrs: '""," ","0","1","2","3","4","5","6","7","8","9","10","a","text"'
            allowInts: "0,1,2,3,4,5,6,7,8,9,10,11,100,1000,512,1024"
            allowFloats: "0.0,0.,0.5,1.0,1.,2.0,2."
  # [securego/gosec: Golang security checker](https://github.com/securego/gosec)
  gosec:
    excludes:
      - G107 # httpè¯·æ±‚æ—¶ä¸èƒ½ä½¿ç”¨åŠ¨æ€urlï¼Œå…³é—­
      - G104 # éƒ¨åˆ†errorä¸éœ€è¦å¤„ç†
      - G307 # Deferring a method which returns an error


issues:
  # Excluding configuration per-path, per-linter, per-text and per-source
  exclude-rules:
    - path: _test\.go
      linters:
        - gomnd

    - path: pkg/golinters/errcheck.go
      text: "SA1019: errCfg.Exclude is deprecated: use ExcludeFunctions instead"
    - path: pkg/commands/run.go
      text: "SA1019: lsc.Errcheck.Exclude is deprecated: use ExcludeFunctions instead"


run:
  skip-dirs:
    - test/testdata_etc
    - internal/cache
    - internal/renameio
    - internal/robustio
